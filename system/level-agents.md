# Агенты уровней

Исполнители. Каждый отвечает за один блок на своём уровне.

## Принцип изоляции

Агент уровня знает ТОЛЬКО:
- Свой контракт (вход/выход)
- Результаты от блоков-зависимостей
- Критерии успеха своего блока

Агент уровня НЕ знает:
- Как устроены другие блоки
- Общую архитектуру системы
- Что происходит выше/ниже его уровня

## Жизненный цикл агента

```
[Создание] → [Ожидание входов] → [Работа] → [Выдача результата] → [Завершение]
                    ↑                              │
                    └──────── если ошибка ─────────┘
```

### 1. Создание

Агент-архитектор создаёт агента с параметрами:
- block_id
- contract (input/output schema)
- dependencies (какие блоки нужны для старта)
- success_criteria

### 2. Ожидание входов

Агент ждёт пока все зависимости выдадут результаты.

Если зависимостей нет (корневой блок) — стартует сразу.

### 3. Работа

Агент выполняет задачу используя:
- Полученные входы
- Свой контракт как ограничение
- Claude Code / Cursor / Cline как инструмент

### 4. Выдача результата

Результат должен соответствовать output schema.

Если соответствует — блок зелёный.
Если нет — блок красный, возврат к работе или эскалация.

### 5. Завершение

После успешной выдачи агент завершается.
Его результат доступен зависимым блокам.

## Параллельная работа

Блоки без взаимных зависимостей работают параллельно:

```
Level 1:  [A] [B] [C]     ← все три параллельно
              ↓
Level 2:     [D]          ← ждёт только B
           ↙   ↘
Level 3: [E]   [F]        ← E и F параллельно
```

## Обработка ошибок

Если блок красный:

1. Агент пытается исправить сам (N попыток)
2. Если не получилось — сигнал агенту-архитектору
3. Архитектор решает: поменять контракт или эскалировать человеку

## Коммуникация между агентами

Агенты НЕ общаются напрямую.

Вся коммуникация через результаты:
- Блок A выдал результат
- Блок B получил результат как вход
- Никакого "разговора" между A и B
